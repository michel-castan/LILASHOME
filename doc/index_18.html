<html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>LILAS-V4</title><!--Généré dynamiquement par PubliTool 2009--><link href="index_2.css" rel="stylesheet"><script src="index_3.js" type="text/javascript">
   </script></head><body><div xmlns:url="http://whatever/java/java.net.URLEncoder" class="zoneTitre"><table class="zoneTitre" width="100%"><tr class="zoneTitre"><td class="colTitreLogo"><embed src="index_4.svg" type="image/svg+xml"></embed></td><td class="colTitreTxt">LILAS-V4</td></tr></table></div><div id="tocFixe"><ul><li class="niv0"><a href="index.html" onClick="return chargerURLavecHistorique(this)">LILAS-V4</a></li><li class="niv1"><a href="index_6.html" onClick="return chargerURLavecHistorique(this)">1 Installation</a></li><li class="niv1"><a href="index_7.html" onClick="return chargerURLavecHistorique(this)">2 Quick start tutorial</a></li><li class="niv2"><a href="index_8.html" onClick="return chargerURLavecHistorique(this)">2.1 demo.hello.Hello</a></li><li class="niv2"><a href="index_11.html" onClick="return chargerURLavecHistorique(this)">2.2 demo.sqrt.SQRT</a></li><li class="niv2"><a href="index_15.html" onClick="return chargerURLavecHistorique(this)">2.3 demo.ctrup.CtrUpDown</a></li><li class="niv3"><a href="index_16.html" onClick="return chargerURLavecHistorique(this)">2.3.1 demo.ctrud.CtrUD_tst</a></li><li class="niv3"><a href="index_17.html" onClick="return chargerURLavecHistorique(this)">2.3.2 demo.ctrud.CtrUDwithClk</a></li><li class="niv3sel"><a href="index_18.html" onClick="return chargerURLavecHistorique(this)">2.3.3 CtrUDwithClk into FPGA</a></li><li class="niv1"><a href="index_19.html" onClick="return chargerURLavecHistorique(this)">3 Launch command</a></li><li class="niv1"><a href="index_20.html" onClick="return chargerURLavecHistorique(this)">4 Configuration file</a></li><li class="niv1"><a href="index_21.html" onClick="return chargerURLavecHistorique(this)">5 Lilas programming</a></li><li class="niv1"><a href="index_64.html" onClick="return chargerURLavecHistorique(this)">6 lilas.bib</a></li><li class="niv1"><a href="index_88.html" onClick="return chargerURLavecHistorique(this)">7 FPGA board</a></li><li class="niv1"><a href="index_91.html" onClick="return chargerURLavecHistorique(this)">8 Lilas examples</a></li></ul></div><div class="zoneMain"><p class="H2c" xmlns:url="http://whatever/java/java.net.URLEncoder">
   - 2.3.3 -</p><p class="H2c" xmlns:url="http://whatever/java/java.net.URLEncoder">CtrUDwithClk into FPGA</p><p style="top:10pt;bottom:5mm;text-align:justify;" xmlns:url="http://whatever/java/java.net.URLEncoder">By executing the command <span style="font-family:monospace;">lilas /demo/ctrud/CtrUDwithClk.lilas -to=fpga</span> we obtain two modules&nbsp;:
<ul id="ID_PubliTool_N103BB">
	<li><span style="font-family:monospace;">CtrUDwithClk_ms6lx9_fpga.lilas</span></li>
	<li><span style="font-family:monospace;">CtrUDwithClk_ms6lx9_pc.lilas</span></li>
</ul>
</p><p class="H3" xmlns:url="http://whatever/java/java.net.URLEncoder">2.3.3.1 CtrUDwithClk_ms6lx9_fpga</p><p style="top:10pt;bottom:5mm;text-align:justify;" xmlns:url="http://whatever/java/java.net.URLEncoder">The first is the <i>LILAS</i> description of a module comprising an instance of the <span style="font-family:monospace;">demo.ctrud.CtrUDwithClk</span> and an instance
of both <span style="font-family:monospace;">lilas.bib.logic.jtag.ToFPGA</span> and <span style="font-family:monospace;">lilas.bib.logic.jtag.FromFPGA</span> modules. The <span style="font-family:monospace;">lilas.bib.logic.jtag.ToFPGA</span>
module is a register which can be loaded through the jtag port of the fpga circuit; it give to the <span style="font-family:monospace;">demo.ctrud.CtrUDwithClk</span> module
all signal input values. The <span style="font-family:monospace;">lilas.bib.logic.jtag.FromFPGA</span>
module is a register which can be read from the jtag port of the fpga circuit; it read from the <span style="font-family:monospace;">demo.ctrud.CtrUDwithClk</span> module
all signal output values. The signals from the board interface such as Clk50M and LedsPins are not cnopsidered by these two modules and arre
directly connected the IO pins of the FPGA.
</p><p style="top:10pt;bottom:5mm;text-align:justify;" xmlns:url="http://whatever/java/java.net.URLEncoder">In order to obtain a bitstream file corresponding to <span style="font-family:monospace;">demo.ctrud.CtrUDwithClk_ms6lx9_fpga</span> module,  we must
transform the <i>LILAS</i> description to a vhdl description of the module. Fot that, we use the command
<div style="white-space:pre;font-family:monospace;">$ <font color="#0x000086">lilas /demo/ctrud/CtrUDwithClk_ms6lx9_fpga.lilas -to=vhdl</font>
</div>
Then, we can create a bitstream file <span style="font-family:monospace;">demo/ctrud/CtrUDwithClk_ms6lx9_fpga.bit</span> with the command&nbsp;:
<div style="white-space:pre;font-family:monospace;">$ <font color="#0x000086">lilas /demo/ctrud/CtrUDwithClk_ms6lx9_fpga.lilas -to=bit</font>
*** =&gt; /tmp/xilinx2099140377134/demo_ctrud_CtrUDwithClk_ms6lx9_fpga.prj
*** =&gt; /tmp/xilinx2099140377134/demo_ctrud_CtrUDwithClk_ms6lx9_fpga.fileList
*** =&gt; /tmp/xilinx2099140377134/demo_ctrud_CtrUDwithClk_ms6lx9_fpga.xst
*** =&gt; /tmp/xilinx2099140377134/demo_ctrud_CtrUDwithClk_ms6lx9_fpga.ut
*** =&gt; demo/ctrud/CtrUDwithClk_ms6lx9_fpga.log
*** =&gt; demo/ctrud/CtrUDwithClk_ms6lx9_fpga.bit

</div>
File CtrUDwithClk_ms6lx9_fpga.log contains log info for the batch process of the xilinx tools (xst, ngdbuild, map, par, bitgen).
If this batch process fail, the log file indicate the possible errors.
</p><p style="top:10pt;bottom:5mm;text-align:justify;" xmlns:url="http://whatever/java/java.net.URLEncoder">
	If all is right, we can load th bitstream file onto the fpga using the command&nbsp;:
<div style="white-space:pre;font-family:monospace;">$ <font color="#0x000086">lilas /demo/ctrud/CtrUDwithClk_ms6lx9_fpga.lilas -load</font>
** Chgt Library
ftd2xxjava Charg&eacute;!
Configure via JTag termin&eacute;

</div>
</p><p class="H3" xmlns:url="http://whatever/java/java.net.URLEncoder">2.3.3.2 CtrUDwithClk_ms6lx9_pc</p><p style="top:10pt;bottom:5mm;text-align:justify;" xmlns:url="http://whatever/java/java.net.URLEncoder">
	The second module (with its java associated definition <span style="font-family:monospace;">CtrUDwithClk_ms6lx9_pc.java</span>) will allow the
	communication between java and the fpga. 
</p><p style="top:10pt;bottom:5mm;text-align:justify;" xmlns:url="http://whatever/java/java.net.URLEncoder">Now, to be able to communicate input signal value to the fpga, we have to use the commands (if the fpga has been
previously loaded)&nbsp;:
<div style="white-space:pre;font-family:monospace;">$ <font color="#0x000086">lilas /demo/ctrud/CtrUDwithClk_ms6lx9_pc.lilas -awt</font>

</div>	
We can also create a tst file with the same script as <span style="font-family:monospace;">demo.ctrud.CtrUDwithClk_tst</span> module&nbsp;:
<div style="white-space:pre;font-family:monospace;">$ <font color="#0x000086">lilas /demo/ctrud/CtrUDwithClk_ms6lx9_pc_tst.lilas -awt=awt</font>
** Chgt Library
ftd2xxjava Charg&eacute;!
Lilas ready&nbsp;!
**Script main done (6 validated checks of 6) at 57.031ms
Syst&egrave;me termin&eacute;!
Lilas completed&nbsp;!
</div>	

</p><p style="top:10pt;bottom:5mm;text-align:justify;" xmlns:url="http://whatever/java/java.net.URLEncoder">The jar file <span style="font-family:monospace;">LILASHOME/lib/lilasV4demo.jar</span> already contains the test file 
/demo/ctrud/CtrUDwithClk_ms6lx9_pc_tst.lilas with a graphic interface definition awt with the name 
<span style="font-family:monospace;">simple</span>. We can use directly this interface to obtain&nbsp;:
<div style="white-space:pre;font-family:monospace;">$ <font color="#0x000086">lilas /demo/ctrud/CtrUDwithClk_ms6lx9_pc_tst.lilas -awt=simple</font></div>
V&eacute;rification de la cible pour demo.ctrud.CtrUDwithClk_ms6lx9_fpga
** Chgt Library
ftdijava Charg&eacute;!
Step 7
Cible OK
Step 7
Lilas pr&ecirc;t&nbsp;!
**Script main termin&eacute; (6 tests valid&eacute;s sur 6) &agrave; 40.531ms
</p><p style="top:10pt;bottom:5mm;text-align:justify;" xmlns:url="http://whatever/java/java.net.URLEncoder"><div class="centr&eacute;e"><embed src="index_205.svg" type="image/svg+xml"></embed></div>
	We can play with the interface to change the execution of the circuit just by changing the value
of upDown, clear or mode (click in the last column). One can see the evolution of the counter on the 
xindow interface of on the LED of the card (with a 100MHz clock or manual clock).
</p></div></body></html>